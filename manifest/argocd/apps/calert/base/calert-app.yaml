apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: calert-helm
spec:
  destination:
    namespace: argocd
    server: https://kubernetes.default.svc
  project: cluster-apps
  source:
    path: contrib/helm
    repoURL: https://github.com/mr-karan/calert
    helm:
      values: |
        app:
          address: "0.0.0.0:8080"
        service:
          port: "8080"
        templates:
          message.tmpl: |
            *({{.Labels.severity | toUpper }}) {{ .Labels.alertname | Title }} - {{.Status | Title }}*
            {{ range .Annotations.SortedPairs -}}
            {{ .Name | Title }}: {{ .Value}}
            {{ end -}}
      valueFiles:
        - /helm-values/endpoint.yaml
    targetRevision: main
  syncPolicy:
    automated:
      prune: false
      selfHeal: false
